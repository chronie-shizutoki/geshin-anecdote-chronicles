<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>𝒜𝓃ℯ𝒸𝒹ℴ𝓉ℯ 𝒞𝒽𝓇ℴ𝓃𝒾𝒸𝓁ℯ𝓈</title>
    <!-- 百度统计 -->
    <script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?8dbe6f1fa47a8b46d08ec6ea7ea5930c";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
    console.log("百度统计代码已加载");
</script>
    <link rel="stylesheet" href="font/font.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark.css">
    <link rel="stylesheet" href="components/select.css">
    <script src="font/font.js" type="module" defer></script>
    <script src="components/select.js" type="module" defer></script>
    <script src="supabase.js" type="module" defer></script>
    <script src="script.js" type="module" defer></script>
</head>
<body>
    <!-- 前置弹窗 -->
    <div id="prePopup" class="pre-popup">
        <div class="pre-popup-content">
            <h3 id="prePopupTitle"></h3>
            <p id="prePopupContent"></p>
            <button id="prePopupButton" class="btn"></button>
        </div>
    </div>
    
    <div class="scroll-top">
        <span>↑</span>
    </div>
    
    <div class="container">
        <!-- 背景装饰 -->
        <div class="pattern"></div>
        
        <!-- 标题区域 -->
        <header class="header">
            <div class="title-decoration">
                <div class="decoration-left"></div>
                <h1>𝒜𝓃ℯ𝒸𝒹ℴ𝓉ℯ 𝒞𝒽𝓇ℴ𝓃𝒾𝒸𝓁ℯ𝓈</h1>
                <div class="decoration-right"></div>
            </div>
        </header>
        
        <!-- 主要内容区域 -->
        <main class="content">
            <!-- 过滤和搜索区域 -->
            <section class="filter-section">
                <div class="filter-controls">
                    <div class="filter-group">
                        <label for="region-filter">地区：</label>
                        <select id="region-filter">
                            <option value="all">全部地区</option>
                            <option value="蒙德">蒙德</option>
                            <option value="璃月">璃月</option>
                            <option value="稻妻">稻妻</option>
                            <option value="须弥">须弥</option>
                            <option value="枫丹">枫丹</option>
                            <option value="纳塔">纳塔</option>
                            <option value="挪德卡莱">挪德卡莱</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="version-filter">版本：</label>
                        <select id="version-filter">
                            <option value="all">全部版本</option>
                            <option value="5.4">5.4</option>
                            <option value="5.7">5.7</option>
                            <option value="月之一">月之一</option>
                            <option value="月之二">月之二</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="search-input">搜索：</label>
                        <input type="text" id="search-input" placeholder="输入...">
                    </div>
                    <div class="filter-group">
                        <label for="show-completed">仅显示未完成（<span id="incomplete-count">未知</span>个）：</label>
                        <input type="checkbox" id="show-completed">
                    </div>
                    <button id="clear-filter" class="btn">清除</button>
                </div>
            </section>
            
            <section class="filter-section">
                <div class="filter-controls">
                    <!-- 更多选项按钮 -->
                    <button id="more-options-btn" class="btn">更多选项</button>
                    
                    <!-- 更多选项弹窗 -->
                    <div id="more-options-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <h2>更多选项</h2>
                            <div class="more-options-content">
                                <button id="new-version-btn" class="btn">新版本更新内容</button>
                                <button id="notice-btn" class="btn">注意事项</button>
                                <button id="export-data" class="btn">导出数据</button>
                                <div class="file-import-container">
                                    <label for="import-data" class="btn">导入数据</label>
                                    <input type="file" id="import-data" accept=".json" style="display: none;">
                                </div>
                                
                                <!-- 更新日志按钮 -->
                                <button id="update-log-btn" class="btn">更新日志</button>
                                
                                <!-- 字体授权操作按钮 -->
                                <button id="font-license-btn" class="btn">字体设置与授权声明</button>
                                <button id="feedback-btn" class="btn">反馈</button>
                                
                                <!-- 登录状态显示 -->
                                <div class="auth-status-section">
                                    <span id="auth-status" class="auth-status-text">未登录</span>
                                    <button id="auth-signin-trigger" class="btn">登录/注册</button>
                                    <button id="auth-signout" class="btn" style="display: none;">登出</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 注意事项弹窗 -->
            <div id="notice-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>注意事项</h2>
                    <div class="notice-box">
                        <ul class="notice-list">
                            <li>隐藏游逸旅闻目前一般每天仅能<strong>概率触发1条</strong>，若未触发，可于现实时间次日再次尝试</li>
                            <li>当前共有109个记录、117个逸闻印签（完成鹿野院平藏的 [静待] 或爱诺的 [时间足够你道别] 可额外获得5个逸闻印签）</li>
                            <li>
                                关于爱诺［选择］：
                                <ul>
                                    <li>未抽取菈乌玛：持续5日，每次完成获得1个逸闻印签；后续<strong>抽取菈乌玛</strong>解锁［时间足够你道别］，可再获得1个逸闻印签</li>
                                    <li>已抽取菈乌玛：持续1日，解锁［时间足够你道别］可获得5个逸闻印签</li>
                                </ul>
                            </li>
                            <li>
                                快速统计逸闻印签总数的方法：
                                <br>计算公式 = （自助查询路径：联系客服 - 货币记录 - 原石）「游逸旅闻」奖励 +50 的数据条数 × 10 + 游戏内逸闻印签数量
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

                    <!-- 更新日志弹窗 -->
                    <div id="update-log-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <div id="update-log-content">
                                <p class="loading-indicator">加载中...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <!-- 登录/注册弹窗 -->
        <div id="auth-modal" class="modal auth-modal" style="display: none;">
            <div class="modal-content auth-modal-content">
                <span class="close auth-close">&times;</span>
                
                <!-- 弹窗头部：登录和注册选项卡 -->
                <div class="auth-tabs">
                    <button id="signin-tab" class="auth-tab active">登录</button>
                    <button id="signup-tab" class="auth-tab">注册</button>
                </div>
                
                <!-- 登录表单 -->
                <div id="signin-form" class="auth-form active">
                    <h3>用户登录</h3>
                    <input type="email" id="auth-email" placeholder="邮箱" class="auth-input">
                    <input type="password" id="auth-password" placeholder="密码" class="auth-input">
                    <button id="auth-signin" class="btn auth-submit-btn">登录</button>
                </div>
                
                <!-- 注册表单 -->
                <div id="signup-form" class="auth-form">
                    <h3>用户注册</h3>
                    <input type="email" id="auth-email-signup" placeholder="邮箱" class="auth-input">
                    <input type="password" id="auth-password-signup" placeholder="密码" class="auth-input">
                    <p class="auth-note">数据库可能会自动向您发送验证邮件，但此邮件您通常可能无需验证即可登录。</p>
                    <p class="auth-note">注册完成后请您再次登录。</p>
                    <p class="auth-note">如果您无法登录，请检查您的邮箱/密码是否正确，重置密码或需要找回数据等请使用表单反馈。</p>
                    <p class="auth-note">此服务由Supabase提供。</p>
                    <button id="auth-signup" class="btn auth-submit-btn">注册</button>
                </div>
                
                <!-- 错误/状态消息 -->
                <div id="auth-message" class="auth-message"></div>
            </div>
        </div>
                    <!-- 字体授权提示弹窗 -->
                    <div id="font-license-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <p>本系统内置了基于IPA系列日文字体衍生的中文字体：霞鹜新致宋</p>
                            <p>「霞鹜新致宋」和 IPA 原版字体均受 IPA Font License 1.0 保护。</p>
                            <p>根据 IPA Font License1.0 对衍生字体的限制条款，您可以将上述衍生字体恢复到IPA原始授权字体。</p>
                            <p>协议条款及疑难解答请参阅 
                                <a href="https://moii.or.ip/ipafont/license/" target="_blank">https://moii.or.ip/ipafont/license/</a> 及 
                                <a href="https://moji.or.ip/ipafont/faq/" target="_blank">https://moji.or.ip/ipafont/faq/</a>。
                            </p>
                            <p>点击「恢复原始授权字体」后，网页将重新加载，之后系统界面的中文可能会显示异常。</p>
                            <p>恢复原始授权字体后，如果要重新使用上述衍生字体，请点击「重新使用衍生字体」。</p>
                            <p>授权文件：<a href="font/IPA_Font_License_Agreement_v1.0.txt" target="_blank">IPA_Font_License_Agreement_v1.0.txt</a></p>
                            <div class="modal-buttons">
                                <button id="restore-original-font" class="btn">恢复原始授权字体</button>
                                <button id="use-derived-font" class="btn">重新使用衍生字体</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 角色汇总表格区域 -->
            <section class="table-section">
                <h2>游逸旅闻（<span id="current-count">未知</span>/<span id="total-count">未知</span>）</h2>
                <div class="table-container">
                    <table class="character-table">
                        <thead>
                            <tr>
                                <th>完成</th>
                                <th>ID</th>
                                <th>角色</th>
                                <th>版本</th>
                                <th>游逸旅闻<br><small>(斜体为隐藏)</small></th>
                                <th>地点</th>
                                <th>隐藏触发条件</th>
                                <th>额外出场角色</th>
                                <th>描述</th>
                            </tr>
                        </thead>
                        <tbody id="table-body">
                            <!-- 表格内容将由JavaScript动态生成 -->
                        </tbody>
                    </table>
                </div>
            </section>
            
        </main>
        
        <!-- 页脚 -->
        <footer class="footer">
            <div class="footer-content">
                <p>网站更新：2026年01月15日</p>
                <p>元数据更新：2025年10月24日</p>
                <small>「IPAフォント」は、日本の独立行政法人 情報処理推進機構（The Information-Technology Promotion Agency, IPA）の登録商標です。</small>
            </div>
        </footer>
    </div>
</body>
</html>